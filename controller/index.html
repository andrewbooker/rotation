<html>
<head>
<style>
body, button {
    font-size: 200%;
}
button {
    border-radius: 20px;
    padding: 20px;
    margin: 20px;
}
.indicator {
    height: 30px;
}
.buttons {
	max-width: 50%;
	display: flex;
	flex-direction: column;
	align-items: center;
}
.orientation {
	display: flex;
	flex-direction: row;
}
</style>
</head>
<body>
	<div>Speed: <span class="indicator" id="indicator-speed"></span></div>
	<div>Orientation: <span class="indicator" id="indicator-orientation"></span></div>
	<div>Direction: <span class="indicator" id="indicator-direction"></span></div>
	<div class="buttons">
		<div><button id="button-random">Random</button></div>
		<div><button id="button-ahead">Ahead</button></div>
		<div class="orientation">
			<button id="button-left">Left</button>
			<button id="button-right">Right</button>
		</div>
		<div><button id="button-stop">Stop</button></div>
		<div><button id="button-toggleForwardReverse"></button></div>
	</div>
<script>

const g_server = "http://192.168.1.204:9977/"

function setStats(s) {
    document.getElementById("indicator-speed").innerHTML = new Number(s.speed).toFixed(2);
    document.getElementById("indicator-orientation").innerHTML = new Number(s.pos).toFixed(2);
    document.getElementById("indicator-direction").innerHTML = s.isForward ? "Forward" : "Reverse";
    document.getElementById("button-toggleForwardReverse").innerHTML = s.isForward ? "Reverse" : "Forward";
}

function getStats() {
    const get = new XMLHttpRequest();
    get.responseType = "json";
    get.open("GET", g_server, true);
    get.onload  = function() {
        setStats(get.response)
    };
    get.send();
}

function postCommand(cmd) {
    const post = new XMLHttpRequest();
    post.responseType = "json";
    post.open("POST", g_server + cmd, true);
    post.send();
}


["random", "ahead", "left", "right", "stop", "toggleForwardReverse"].map(c => {
    document.getElementById("button-" + c).setAttribute("onclick", "postCommand(\"" + c + "\");");
});

setInterval(getStats, 600)
</script>
</body>
</html>
